# MOOSE Newsletter (November 2024)

## MOOSE Improvements

### Default support for multiple solver systems in the Steady and Transient executioners

The [Steady.md] and [Transient.md] executioner, as well as any `Executioner` relying on a [FEProblemSolve.md] solve object
can now solve multiple solver systems, e.g. nonlinear or linear systems. A variable can be placed in a solver system
using the `solver_sys` parameter of the `Variable`.

The solve of multiple systems can be iterated using the [!param](/Executioner/Transient/multi_system_fixed_point) parameter.
A [Convergence object](syntax/Convergence/index.md) must then be specified to the `Executioner` to assess the convergence
of the multi-system fixed point iteration.

This support was also extended to the [Physics system](syntax/Physics/index.md), in which the `Physics` equations can be
set to be solved in their own solver system

## libMesh-level Changes

## PETSc-level Changes

- Add `MatCopyHashToXAIJ()` which allows assembling an XAIJ matrix in hash table
  form into another XAIJ matrix. Additionally added `MatResetHash()` which
  allows resetting an XAIJ matrix to use a hash table. Both of these
  developments will be leveraged in libMesh and MOOSE for simulations in which
  the sparsity pattern changes dynamically, rendering an initial preallocation
  invalid. By using a hash table in these cases as opposed to a preallocation,
  we can avoid new nonzero allocations which can sometimes slow simulations down by orders
  of magnitude
- Add `PetscCtxDestroyFn` as the prototype for all context destroy functions. It is `PetscErrorCode
  ()(void **)`. Previously some context destructor setters took `PetscErrorCode ()(void *)`. But
  these would not work directly with PETSc objects as contexts and having two different context
  destructor models added unneeded complexity to the library. This change is not backward compatible
- Deprecate `PetscContainerSetUserDestroy()` with `PetscContainerSetCtxDestroy()`, updating will
  require a small change in calling code
- Deprecate `PetscContainerCtxDestroyDefault` with `PetscCtxDestroyDefault()`
- Add `PetscIntViewNumColumns()`, `PetscScalarViewNumColumns()`, and `PetscRealViewNumColumns()`
- Update `--download-pastix` to use CMake build, with additional dependency on LAPACKE and CBLAS,
  can use for ex. MKL with `--with-blaslapack-dir=${MKLROOT}`, or Netlib LAPACK with
  `--download-netlib-lapack --with-netlib-lapack-c-bindings`
- Add option `--with-library-name-suffix=<suffix>`
- Add `PetscCIntCast()`
- Add `PetscObjectHasFunction()` to query for the presence of a composed method
- Add `ISGetCompressOutput()` and `ISSetCompressOutput()`
- Deprecate `DMGetSection()` and `DMSetSection()` for existing `DMGetLocalSection()` and
  `DMSetLocalSection()`
- Add `DMSwarmSortRestorePointsPerCell()`
- Change `DMSwarmVectorGetField()` and add `DMSwarmVectorDefineFields()` to handle multiple fields
- Add `DMSwarmGetCoordinateField()` and `DMSwarmSetCoordinateField()`
- Add `DMSwarmComputeMoments()`
- Add `DMSwarmPushCellDM()` and `DMSwarmPopCellDM()`
- Add `DMPlexTransformGetMatchStrata()` and `DMPlexTransformSetMatchStrata()`
- Deprecate `DMPlexSetGlobalToNaturalSF()` and `DMPlexGetGlobalToNaturalSF()` for existing
  `DMSetNaturalSF()` and `DMGetNaturalSF()`
- Add `-dm_plex_box_label_bd` to setup isoperiodicity when using `-dm_plex_box_label_bd`


## Bug Fixes and Minor Enhancements

- Periodic boundary conditions are now more verbose, they will output intermediate setup data
  in their 'auto_detection' mode, and will error with a helpful error message if used using conflictual
  parameters, or with a non-existing primary or secondary boundary.
- All `Sampler` vectorpostprocessor will now correctly detect and throw an error when used with
  vector and array variables which they currently do not support. New `Sampler` VPPs could be created
  to support them.
- [ProjectionAux.md] can now handle 1D elements in a multi-dimensional mesh, such as for example
  thermal hydraulic channels in a multi-dimensional loop

## Conda Package Changes
